#!/bin/bash

THIS_DIR="$(cd "$(dirname "$BASH_SOURCE")"; pwd)"
BASE_DIR="$(dirname $(dirname $THIS_DIR))"

. $BASE_DIR/lib/bash_include/config.bash

SOURCE_DIR="$BASE_DIR"

cd $TEST_IMAGE_SOURCE_DIR || { echo "ERROR: $(basename $0): FAILED to cd to $TEST_IMAGE_SOURCE_DIR" >&2; exit 1; }

docker rmi -f $TEST_IMAGE_FULLNAME $(docker images --filter "reference=$TEST_IMAGE_FULLNAME:*" -q --no-trunc)
docker image ls | grep "\\b$TEST_IMAGE_FULLNAME\\b" && { echo "ERROR: $(basename $0): oops, found test image after supposedly deleting it" >&2; exit 1; }
